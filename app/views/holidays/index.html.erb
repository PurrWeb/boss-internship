<%= react_component("HolidayReportApp") %>

<%= javascript_tag do %>
  var holidays = <%= raw render partial: 'api/v1/shared/holidays.json', locals: { holidays: holidays } %>;

  var staffMembers = <%= raw render partial: 'api/v1/shared/staff_members.json', locals: { staff_members: staff_members.includes(:work_venues) } %>;

  var venues = <%= raw render partial: 'api/v1/shared/venues.json', locals: { venues: Venue.all } %>;

  var accessibleVenueIds = <%= accessible_venues.map(&:id) %>;

  var staffTypes = <%= raw render partial: 'api/v1/shared/staff_types.json', locals: { staff_types: staff_types } %>;

  window.boss = window.boss || {};
  window.boss.store = window.boss.store || {};
  window.boss.store.holidays = holidays;
  window.boss.store.staffMembers = staffMembers;
  window.boss.store.venues = venues;
  window.boss.store.staffTypes = staffTypes;
  window.boss.store.access_token = "<%= access_token.token %>";

  window.boss.store.pageData = {
    accessibleVenueIds: accessibleVenueIds,
    venueId: <%= filter_venue.try(:id) || 'null' %>,
    weekStartDate: "<%= week.start_date.iso8601 %>",
    weekEndDate: "<%= week.end_date.iso8601 %>",
    displayCsvLink: <%= can?(:view, :holidays_csv).to_s %>
  }
<% end %>
